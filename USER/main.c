#include "stm32f10x.h"
#include "delay.h"
#include "sys.h"
#include "usart.h"
#include "timer2_int.h"
#include "timer3_int.h"
#include "oled.h"
#include "bmp.h"
/* home->alarm->set->map */
#include "math.h"
#include "io.h"
#include "led.h"
#include "key.h"
#include "rtc.h"

u8 B_1[] = 


{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFF,0xFF,0xFF,0xFF,0x7F,0x00,0x00,0xFF,0xFF,0x7F,0xF8,0xFF,0xFF,0x01,0xC0,0xFF,0xFF,0x3F,0xF0,0xFF,0xFF,0x03,0xE0,0xFF,0xFF,0x1F,0xF0,0xFF,0xFF,0x07,0xF0,0xFF,0xFF,0x0F,0xF0,0xFF,0xFF,0x0F,0xF0,0xFF,0xFF,0x07,0xF0,0xFF,0xFF,0x1F,0xF8,0xFF,0xFF,0x03,0xFC,0xFF,0xFF,0x1F,0xF8,0xFF,0xFF,0x01,0xFC,0xFF,0xFF,0x3F,0xFC,0xFF,0xFF,0x00,0x00,0x00,0xF8,0x3F,0xFC,0xFF,0x7F,0x00,0x00,0x00,0xE0,0x3F,0xFC,0xFF,0x3F,0x00,0x00,0x00,0xC0,0x3F,0xFC,0xFF,0x1F,0x00,0x00,0x00,0x80,0x3F,0xFC,0xFF,0x0F,0x00,0x00,0x00,0x00,0x3F,0xFC,0xFF,0x07,0x00,0x00,0x00,0x00,0x3F,0xFC,0xFF,0x03,0xFC,0xFF,0xFF,0x01,0x3E,0xFC,0xFF,0x01,0xFE,0xFF,0xFF,0x03,0x3E,0xFC,0xFF,0x00,0xFF,0xFF,0xFF,0x07,0x3C,0xFC,0x7F,0x80,0xFF,0xFF,0xFF,0x0F,0x3C,0xFC,0x3F,0xC0,0xFF,0xF0,0xFF,0x0F,0x3C,0xFC,0x1F,0xE0,0x3F,0xC0,0xFF,0x0F,0x3C,0xFC,0x0F,0xF0,0x1F,0x00,0xFF,0x0F,0x3C,0xFC,0x07,0xF8,0x0F,0x00,0xFE,0x0F,0x3C,0xFC,0x03,0xFC,0x0F,0x00,0xFC,0x0F,0x3C,0xFC,0x01,0xFE,0x0F,0x00,0xF8,0x0F,0x3C,0xFC,0x00,0xFF,0x07,0x00,0xF0,0x0F,0x3C,0x7C,0x80,0xFF,0x07,0x00,0xE0,0x0F,0x3C,0x7C,0xC0,0xFF,0x07,0x00,0xE0,0x0F,0x3C,0x3C,0xE0,0xFF,0x0F,0x00,0xC0,0x0F,0x3C,0x3C,0xF0,0xFF,0x0F,0x00,0x80,0x0F,0x3C,0x3C,0xF0,0xFF,0x1F,0x00,0x80,0x0F,0x3C,0x3C,0xE0,0xFF,0x1F,0x00,0x80,0x0F,0x3C,0x3C,0xC0,0xFF,0x0F,0x00,0xC0,0x0F,0x3C,0x3C,0x80,0xFF,0x0F,0x00,0xC0,0x0F,0x3C,0x7C,0x00,0xFF,0x07,0x00,0xE0,0x0F,0x3C,0xFC,0x00,0xFE,0x07,0x00,0xF0,0x0F,0x3C,0xFC,0x01,0xFC,0x07,0x00,0xF0,0x0F,0x3C,0xFC,0x03,0xF8,0x0F,0x00,0xF8,0x0F,0x3C,0xFC,0x07,0xF0,0x0F,0x00,0xFC,0x0F,0x3C,0xFC,0x0F,0xE0,0x1F,0x00,0xFE,0x0F,0x3C,0xFC,0x1F,0xC0,0x1F,0x80,0xFF,0x0F,0x7C,0xFC,0x3F,0x80,0x7F,0xC0,0xFF,0x0F,0x3C,0xFC,0x7F,0x00,0xFF,0xFF,0xFF,0x0F,0x3C,0xFC,0xFF,0x00,0xFE,0xFF,0xFF,0x0F,0x3C,0xFC,0xFF,0x01,0xFC,0xFF,0xFF,0x07,0x3C,0xFC,0xFF,0x03,0xF8,0xFF,0xFF,0x03,0x3E,0xFC,0xFF,0x07,0xF0,0xFF,0xFF,0x00,0x3E,0xFC,0xFF,0x0F,0x00,0x00,0x00,0x00,0x3F,0xFC,0xFF,0x1F,0x00,0x00,0x00,0x00,0x3F,0xFC,0xFF,0x3F,0x00,0x00,0x00,0x80,0x3F,0xFC,0xFF,0x7F,0x00,0x00,0x00,0xC0,0x3F,0xFC,0xFF,0xFF,0x00,0x00,0x00,0xF0,0x3F,0xF8,0xFF,0xFF,0x01,0x00,0x00,0xFF,0x3F,0xF8,0xFF,0xFF,0x03,0xFC,0xFF,0xFF,0x3F,0xF8,0xFF,0xFF,0x07,0xF8,0xFF,0xFF,0x1F,0xF0,0xFF,0xFF,0x0F,0xF0,0xFF,0xFF,0x1F,0xE0,0xFF,0xFF,0x1F,0xF0,0xFF,0xFF,0x0F,0xE0,0xFF,0xFF,0x3F,0xF0,0xFF,0xFF,0x07,0x80,0xFF,0xFF,0x7F,0xF8,0xFF,0xFF,0x03,0x00,0xFF,0xFF,0xFF,0xFC,0xFF,0xFF,0x00,0x00,0xFC,0xFF,0xFF,0xFF,0xFF,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};/*"C:\Users\12586\Desktop\home.bmp",0*/


u8 A_1[] = 
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x1F,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0xFF,0x01,0x00,0x00,0x00,0x00,0x00,0xF8,0xF9,0x01,0x00,0x00,0x00,0x00,0x00,0xFC,0xF0,0x03,0x00,0x00,0x00,0x00,0x00,0xFC,0xF0,0x03,0x00,0x00,0x00,0x00,0x00,0x7E,0xE0,0x07,0x00,0x00,0x00,0x00,0x00,0x7E,0xE0,0x07,0x00,0x00,0x00,0x00,0x00,0x3E,0xC0,0x07,0x00,0x00,0x00,0x00,0x00,0x3F,0xC0,0x0F,0x00,0x00,0x00,0x00,0x00,0x3F,0xC0,0x0F,0x00,0x80,0xFF,0x00,0x00,0x1F,0x80,0x0F,0x00,0xF0,0xFF,0x07,0x00,0x1F,0x80,0x0F,0x00,0xFC,0xFF,0x1F,0x80,0x1F,0x80,0x1F,0x00,0xFE,0xFF,0x7F,0x80,0x1F,0x80,0x1F,0x00,0xFF,0xFF,0xFF,0x01,0x0E,0x00,0x1F,0x80,0xFF,0xFF,0xFF,0x07,0x0C,0x00,0x1F,0xC0,0xFF,0xFF,0xFF,0x0F,0x00,0x00,0x1F,0xE0,0xFF,0xFF,0xFF,0x3F,0x00,0x00,0x1F,0xE0,0xFF,0xFF,0xFF,0x7F,0x00,0x00,0x3F,0xF0,0xFF,0xFF,0xFF,0xFF,0x01,0x00,0x3F,0xF0,0xFF,0xE3,0xFF,0xFF,0x03,0x00,0x3F,0xF8,0xFF,0x80,0xFF,0xFF,0x0F,0x00,0x3F,0xF8,0x3F,0x00,0xFE,0xFF,0x1F,0x00,0x3E,0xF8,0x3F,0x00,0xFC,0xFF,0x3F,0x00,0x3E,0xFC,0x1F,0x00,0xFC,0xFF,0xFF,0x00,0x3E,0xFC,0x1F,0x00,0xF8,0xFF,0xFF,0x01,0x3E,0xFC,0x0F,0x00,0xF8,0xFF,0xFF,0x01,0x3E,0xFC,0x0F,0x00,0xF8,0xFF,0xFF,0x01,0x3E,0xFC,0x0F,0x00,0xF8,0xFF,0xFF,0x01,0x3E,0xFC,0x0F,0x00,0xF8,0xFF,0xFF,0x01,0x3E,0xFC,0x1F,0x00,0xF8,0xFF,0xFF,0x01,0x3E,0xFC,0x1F,0x00,0xFC,0xFF,0xFF,0x00,0x3E,0xF8,0x3F,0x00,0xFC,0xFF,0x3F,0x00,0x3E,0xF8,0x7F,0x00,0xFE,0xFF,0x1F,0x00,0x3E,0xF8,0xFF,0x80,0xFF,0xFF,0x0F,0x00,0x3F,0xF0,0xFF,0xE7,0xFF,0xFF,0x03,0x00,0x3F,0xF0,0xFF,0xFF,0xFF,0xFF,0x01,0x00,0x3F,0xE0,0xFF,0xFF,0xFF,0x7F,0x00,0x00,0x1F,0xE0,0xFF,0xFF,0xFF,0x3F,0x00,0x00,0x1F,0xC0,0xFF,0xFF,0xFF,0x0F,0x00,0x00,0x1F,0x80,0xFF,0xFF,0xFF,0x03,0x0C,0x00,0x1F,0x00,0xFF,0xFF,0xFF,0x01,0x0F,0x00,0x1F,0x00,0xFE,0xFF,0x7F,0x80,0x1F,0x80,0x1F,0x00,0xF8,0xFF,0x1F,0x80,0x1F,0x80,0x1F,0x00,0xF0,0xFF,0x07,0x00,0x1F,0x80,0x0F,0x00,0x80,0xFF,0x00,0x00,0x1F,0x80,0x0F,0x00,0x00,0x00,0x00,0x00,0x3F,0xC0,0x0F,0x00,0x00,0x00,0x00,0x00,0x3F,0xC0,0x0F,0x00,0x00,0x00,0x00,0x00,0x3E,0xC0,0x07,0x00,0x00,0x00,0x00,0x00,0x7E,0xE0,0x07,0x00,0x00,0x00,0x00,0x00,0x7E,0xE0,0x07,0x00,0x00,0x00,0x00,0x00,0xFC,0xF0,0x03,0x00,0x00,0x00,0x00,0x00,0xFC,0xF0,0x03,0x00,0x00,0x00,0x00,0x00,0xF8,0xF9,0x01,0x00,0x00,0x00,0x00,0x00,0xF8,0xFF,0x01,0x00,0x00,0x00,0x00,0x00,0xF0,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x1F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};/*"C:\Users\12586\Desktop\map.bmp",0*/

u8 A_2[128][8],B_2[128][8];


/*
建立两个128*64的数组
OLED_GRAM[128][8]
OLED_GRAM_TEMP[128][8]
分别写入不同的显示内容
	取模方式：阴码，逆向，逐列式，C51，行后缀};
*/
void OLED_Roll(u8 OLED_GRAM[128][8],u8 OLED_GRAM_TEMP[128][8])
{
    unsigned char step,i,n;
    for(step=0; step<128; step++)
    {
        for(i=0; i<8; i++)
        {
            OLED_Set_Pos(step,i);
            for(n=0; n<(128 - step); n++)OLED_WR_Byte(OLED_GRAM[n][i],OLED_DATA);
            OLED_Set_Pos(0,i);
            for(n =(128 -step); n<128; n++)OLED_WR_Byte(OLED_GRAM_TEMP[n][i],OLED_DATA);
        }
        delay_ms((128-step)/2);//实现滚动变速效果
    }
}



int main(void)
{
    u8 i,j;
    u8 ROW = 128,COL = 8;
    unsigned char step,m,n;

    delay_init();	    	 	//延时函数初始化
    NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);
    uart_init(115200);	 		//串口初始化为115200
    delay_ms(1000);				//上电延时，外设上电准备阶段
    //TIM2_Int_Init(4999,7199);	//72000000/(7199+1)/(5000) = 2hz
    //TIM3_Int_Init(499,7199);	//72000000/(7199+1)/(500) = 20hz
    //RTC_Init();	  				//RTC初始化
    //IO_Init();
    //LED_Init();			     	//LED端口初始化
    //KEY_Init();          		//初始化与按键连接的硬件接口
    OLED_Init();
    OLED_Refresh();				//显示一组字符等之后需要用这个刷新显存
    OLED_Clear();
    //数组转换
    for(i=0; i<ROW; i++)
    {
        for(j=0; j<COL; j++)
        {
            A_2[i][j]=A_1[i*COL+j];
        }
    }
    for(i=0; i<ROW; i++)
    {
        for(j=0; j<COL; j++)
        {
            B_2[i][j]=B_1[i*COL+j];
        }
    }
    while(1)
    {
        //主界面
        //OLED_DrawBMP(0,0,128,8,gImage_home);


        for(step=0; step<255; step ++)
        {
            for(m=0; m<8; m++)
            {
                OLED_Set_Pos(step,m);
                for(n=0; n<(128 - step); n++)OLED_WR_Byte(A_2[n][m],OLED_DATA);
                OLED_Set_Pos(0,m);
                for(n =(128 -step); n<128; n++)OLED_WR_Byte(B_2[n][m],OLED_DATA);
            }
            //delay_ms((128-step)/20);//实现滚动变速效果
			//delay_ms(1);
        }
    }
}




